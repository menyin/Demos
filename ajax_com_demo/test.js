define('module.css3',function(require,exports,module){var util=require('base.util'),win=window,doc=document,elementStyle=doc.createElement('div').style;exports.style={getStyleName:function(){var vendors=['t','webkitT','MozT','msT','OT'],transform,i=0,l=vendors.length;for(;i<l;i++){transform=vendors[i]+'ransform';if(transform in elementStyle)return vendors[i].substr(0,vendors[i].length-1);}
        return false;},prefixStyle:function(style){var styleName=this.getStyleName();if(styleName===false)return false;if(styleName==='')return style;return styleName+style.charAt(0).toUpperCase()+style.substr(1);},isAnimateSupport:function(){return this.transform in elementStyle},getTranslate:function(el,axis){var matrix,curTransform,curStyle,transformMatrix;if(typeof axis==='undefined'){axis='x';}
        if(el.jquery&&el.length){el=el[0];}
        curStyle=win.getComputedStyle(el,null);if(win.WebKitCSSMatrix){transformMatrix=new WebKitCSSMatrix(curStyle.webkitTransform==='none'?'':curStyle.webkitTransform);}else{transformMatrix=curStyle.MozTransform||curStyle.transform||curStyle.getPropertyValue('transform').replace('translate(','matrix(1, 0, 0, 1,');matrix=transformMatrix.toString().split(',');}
        if(axis==='x'){if(win.WebKitCSSMatrix)
            curTransform=transformMatrix.m41;else if(matrix.length===16)
            curTransform=parseFloat(matrix[12]);else
            curTransform=parseFloat(matrix[4]);}else if(axis==='y'){if(window.WebKitCSSMatrix)
            curTransform=transformMatrix.m42;else if(matrix.length===16)
            curTransform=parseFloat(matrix[13]);else
            curTransform=parseFloat(matrix[5]);}
        return curTransform||0;}};exports.isTouchSupport=(function(){return!!(('ontouchstart'in win)||win.DocumentTouch&&doc instanceof win.DocumentTouch)})();exports.touchEvents={start:exports.isTouchSupport?'touchstart':'mousedown',move:exports.isTouchSupport?'touchmove':'mousemove',end:exports.isTouchSupport?'touchend':'mouseup',cancel:exports.isTouchSupport?'touchcancel':null}
    exports.style.transform=exports.style.prefixStyle('transform');exports.style.transitionProperty=exports.style.prefixStyle('transitionProperty');exports.style.transitionTimingFunction=exports.style.prefixStyle('transitionTimingFunction');exports.style.transitionDuration=exports.style.prefixStyle('transitionDuration');exports.style.transitionDelay=exports.style.prefixStyle('transitionDelay');exports.style.transformOrigin=exports.style.prefixStyle('transformOrigin');exports.style.hasPerspective=exports.style.prefixStyle('perspective')in elementStyle;exports.style.hasTransition=exports.style.prefixStyle('transition')in elementStyle;exports.style.hasTransform=exports.style.transform!==false;var transitionEvent='transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd';function _dealCssEvent(dom,events,callback){function fireCallBack(e){if(e.target!==this)return;callback.call(this,e);dom.off(transitionEvent,fireCallBack);}
        if(callback){dom.on(transitionEvent,fireCallBack);}}
    exports.animationEnd=function(dom,callback){if(!dom.jquery){dom=$(dom);}
        _dealCssEvent.call(dom,callback);};exports.raf=win.requestAnimationFrame||win.webkitRequestAnimationFrame||win.mozRequestAnimationFrame||win.oRequestAnimationFrame||win.msRequestAnimationFrame||function(callback){win.setTimeout(callback,1000/60);};exports.caf=win.cancelAnimationFrame||win.webkitCancelAnimationFrame||win.mozCancelAnimationFrame||win.msCancelAnimationFrame||function(id){win.clearTimeout(id);}
    exports.ease={quadratic:{style:'cubic-bezier(0.25, 0.46, 0.45, 0.94)',fn:function(k){return k*(2-k);}},circular:{style:'cubic-bezier(0.1, 0.57, 0.1, 1)',fn:function(k){return Math.sqrt(1-(--k*k));}},back:{style:'cubic-bezier(0.175, 0.885, 0.32, 1.275)',fn:function(k){var b=4;return(k=k-1)*k*((b+1)*k+b)+1;}},bounce:{style:'',fn:function(k){if((k/=1)<(1/2.75)){return 7.5625*k*k;}else if(k<(2/2.75)){return 7.5625*(k-=(1.5/2.75))*k+0.75;}else if(k<(2.5/2.75)){return 7.5625*(k-=(2.25/2.75))*k+0.9375;}else{return 7.5625*(k-=(2.625/2.75))*k+0.984375;}}},elastic:{style:'',fn:function(k){var f=0.22,e=0.4;if(k===0){return 0;}
                if(k==1){return 1;}
                return(e*Math.pow(2,-10*k)*Math.sin((k-f/4)*(2*Math.PI)/f)+1);}}};exports.animation={momentum:function(current,start,time,lowerMargin,wrapperSize,deceleration){var distance=current-start,speed=Math.abs(distance)/time,destination,duration;deceleration=!deceleration?0.0006:deceleration;destination=current+(speed*speed)/(2*deceleration)*(distance<0?-1:1);duration=speed/deceleration;if(destination<lowerMargin){destination=wrapperSize?lowerMargin-(wrapperSize/2.5*(speed/8)):lowerMargin;distance=Math.abs(destination-current);duration=distance/speed;}else if(destination>0){destination=wrapperSize?wrapperSize/2.5*(speed/8):0;distance=Math.abs(current)+destination;duration=distance/speed;}
            return{destination:Math.round(destination),duration:duration}}}
    return exports;});;define('tools.iframe',['tools.position'],function(require,exports,module){var $=module['jquery'],position=require('tools.position'),isIE6=(window.navigator.userAgent||'').toLowerCase().indexOf('msie 6')!==-1;function iframe(target){this.target=$(target).eq(0);}
    iframe.prototype.resize=function(width,height){var target=this.target;if(!target.length)return;height=height||target.outerHeight();width=width||target.outerWidth();this.iframe&&this.iframe.css({'height':height,'width':width});}
    iframe.prototype.hide=function(){var target=this.target;if(!target.length)return this;this.iframe&&this.iframe.hide();}
    iframe.prototype.shim=function(){var target=this.target;var iframe=this.iframe;if(!target.length)return this;var height=target.outerHeight();var width=target.outerWidth();if(!height||!width||target.is(':hidden')){this.hide();}else{iframe||(iframe=this.iframe=createIframe(target));iframe.css({'height':height,'width':width,'background':'#ff0'});position.pin(iframe[0],target[0]);iframe.show();}
        return this;};iframe.prototype.destory=function(){if(this.iframe){this.iframe.remove();delete this.iframe;}
        delete this.target;};if(isIE6){exports.shim=iframe;}else{function noop(){}
        noop.prototype.shim=noop.prototype.resize=function(){return this};noop.prototype.destory=noop;exports.shim=noop;}
    function createIframe(target){var css={display:'none',border:'none',opacity:0,position:'absolute'};var zIndex=target.css('zIndex');if(zIndex&&zIndex>0){css.zIndex=zIndex-1;}
        return $('<iframe>',{src:'javascript:',frameborder:0,css:css}).insertBefore(target);}});;define('tools.position',function(require,exports,module){var viewport={_id:'viewport',nodeType:1},util=require('base.util'),$=module['mobile']||module['jquery'],isPinFixed=false,win=window,doc=document,isIE6=!-[1,]&&!win.XMLHttpRequest;exports.setDocument=function(w,d){win=w||window;doc=d||document;},exports.pin=function(pinObject,baseObject,topObject,callback){if(util.type.isFunction(topObject)){callback=topObject;topObject=null;}
    pinObject=normalize(pinObject);baseObject=normalize(baseObject);topObject=topObject&&normalize(topObject);var pinElement=$(pinObject.element);if(pinElement.css('position')!=='fixed'||isIE6){pinElement.css('position','absolute');isPinFixed=false;}
    else{isPinFixed=true;}
    posConverter(pinObject);posConverter(baseObject);topObject&&posConverter(topObject);var parentOffset=getParentOffset(pinElement),baseOffset=baseObject.offset(),topOffset=topObject&&topObject.offset();var top=((topOffset&&(topOffset.top+topObject.y))||(baseOffset.top+baseObject.y))-
        pinObject.y-parentOffset.top;var left=baseOffset.left+baseObject.x-
        pinObject.x-parentOffset.left;if(callback){callback.call(this,{target:pinElement,left:left,top:top});}else{pinElement.css({left:left,top:top});}}
    exports.center=function(pinElement,baseElement){this.pin({element:pinElement,x:'50%',y:'50%'},{element:baseElement,x:'50%',y:'50%'});};exports.viewport=viewport;function normalize(posObject){posObject=$(posObject)[0]||{};if(posObject.nodeType){posObject={element:posObject};}
        var element=$(posObject.element)[0]||viewport;if(element.nodeType!==1){throw new Error('assists.position: 无效HTML标签');}
        var result={element:element,x:posObject.x||0,y:posObject.y||0};var isViewport=(element===viewport||element._id==='viewport');result.offset=function(){if(isPinFixed){return{left:0,top:0};}else if(isViewport){return{left:$(doc).scrollLeft(),top:$(doc).scrollTop()};}else{return getOffset($(element)[0]);}};result.size=function(){var el=isViewport?$(win):$(element);return{width:el.outerWidth(),height:el.outerHeight()};};return result;}
    function posConverter(pinObject){pinObject.x=xyConverter(pinObject.x,pinObject,'width');pinObject.y=xyConverter(pinObject.y,pinObject,'height');}
    function xyConverter(x,pinObject,type){x=x+'';x=x.replace(/px/gi,'');if(/\D/.test(x)){x=x.replace(/(?:top|left)/gi,'0%').replace(/center/gi,'50%').replace(/(?:bottom|right)/gi,'100%');}
        if(x.indexOf('%')!==-1){x=x.replace(/(\d+(?:\.\d+)?)%/gi,function(m,d){return pinObject.size()[type]*(d/100.0);});}
        if(/[+\-*\/]/.test(x)){try{x=(new Function('return '+x))();}catch(e){throw new Error('assists.position: 无效数值: '+x);}}
        return numberize(x);}
    function getParentOffset(element){var parent=element.offsetParent();if(parent[0]===doc.documentElement){parent=$(doc.body);}
        if(isIE6){parent.css('zoom',1);}
        var offset;if(parent[0]===doc.body&&parent.css('position')==='static'){offset={top:0,left:0};}else{offset=getOffset(parent[0]);}
        offset.top+=numberize(parent.css('border-top-width'));offset.left+=numberize(parent.css('border-left-width'));return offset;}
    function numberize(s){return parseFloat(s,10)||0;}
    function getOffset(element){var box=element.getBoundingClientRect(),docElem=doc.documentElement;return{left:box.left+(win.pageXOffset||docElem.scrollLeft)-
        (docElem.clientLeft||doc.body.clientLeft||0),top:box.top+(win.pageYOffset||docElem.scrollTop)-
        (docElem.clientTop||doc.body.clientTop||0)};}
    return exports;});;define('widge.popup',['tools.position','tools.iframe','module.css3'],function(require,exports,module){var shape=module['base.shape'],$=module['jquery'],util=require('base.util'),position=require('tools.position'),css3=require('module.css3'),shim=require('tools.iframe').shim,template='<div></div>',defaultName='hb_ui',doc=document,win=window,isAnimateSupport=css3.style.isAnimateSupport()&&!(/\bMSIE [6789]\.0\b/.test(navigator.userAgent));var popup=shape(function(o){popup.parent().call(this,util.merge({idName:null,className:'popup',width:200,height:100,zIndex:99,visible:false,align:{selfXY:[0,0],baseElement:position.viewport,baseXY:[0,0],topElement:position.viewport,topXY:null},content:null,transitionType:false},o));this.init();});popup.implement({init:function(){this.after('_render',function(){var pos=this.get('element').css('position');if(pos==='static'||pos==='relative'){this.get('element').css({position:this.get('position')||'absolute',left:'-9999px',top:'-9999px'});}
        this.setLevel();});this._render();this._createShim();this._setupResize();this.after('show',function(){this.setPosition();});if(this.get('visible')){this.get('element').show();}},_render:function(){var element,target,className=normalizeClassName(this.get('className'));if(element=this.get('element')){if(util.type.isString(this.get('element'))){element=$(this.get('element'));this.set('element',element);}else if(this.get('element')[0]){element=this.get('element');}}else{element=$(template);this.set('element',element);}
        element.addClass(className);this.addClass(this.get('idName'),true);this.resetSize();this._toTarget();},setDocument:function(w,d){doc=d||document;win=w||window;position.setDocument(w,d);},_toTarget:function(){this.get('element').appendTo(doc.body).hide();},_setupResize:function(){popup.allPopups.push(this);},_createShim:function(){var iframe=this._iframe=new shim(this.get('element'));this.after('setPosition',util.bind(iframe.shim,iframe));this.after('hide',util.bind(iframe.hide,iframe));var attrs=['width','height'];for(var attr in attrs){if(attrs.hasOwnProperty(attr)){this.on('change:'+attr,util.bind(iframe.shim,iframe));}}
        this.before('destory',util.bind(iframe.destory,iframe));},addClass:function(idName,isInit){!isInit&&idName!=undefined&&this.set('idName',idName);if(idName){var element=this.get('element');idName=this.get('idName');if(util.type.isArray(idName)){$(idName).each(function(index,val){element.addClass(val);})}else{element.addClass(idName);}}
        return this;},clearClass:function(){var idName=this.get('idName');if(idName){var element=this.get('element');if(util.type.isArray(idName)){$(idName).each(function(index,val){element.removeClass(val);});}else{element.removeClass(idName);}
        idName&&this.set('idName',null);}
        return this;},setLevel:function(zIndex){zIndex!=undefined&&this.set('zIndex',zIndex);this.get('element').css('z-index',this.get('zIndex')||0);},resetSize:function(width,height){var element=this.get('element');element.css({width:width||this.get('width')||'auto',height:height||this.get('height')||'auto'});return this;},setPosition:function(align,callback){var element=this.get('element');if(!this.isInDocument(element[0]))return;align||(align=this.get('align'));if(!align)return;var isHidden=element.css('display')==='none';if(isHidden){element.css({visibility:'hidden',display:'block'});}
        var pinObj={element:element,x:align.selfXY[0],y:align.selfXY[1]},baseObj={element:align.baseElement,x:align.baseXY[0],y:align.baseXY[1]},topObj={};if(align.topXY){topObj.x=align.topXY[0];topObj.y=align.topXY[1];topObj.element=align.topElement;position.pin(pinObj,baseObj,topObj,callback);}else{position.pin(pinObj,baseObj,callback);}
        if(isHidden){element.css({visibility:'',display:'none'});}},isInDocument:function(element){return $.contains(doc.documentElement,element);},_useTransition:function(type){var transitionType=this.get('transitionType');if(!isAnimateSupport||!transitionType)return false;var firstClassName=type.substring(0,1);this.trigger('transition'+type.replace(firstClassName,firstClassName.toLowerCase()));var element=this.get('element');var typeClass=this._getTransitionClass(type);element.addClass(typeClass);return typeClass?true:false;},_getTransitionClass:function(type){var transitionType=this.get('transitionType');switch(transitionType){case'scale':return'hb_ui_scale_'+type;case'opacity':return'hb_ui_opacity_'+type;case'none':var firstClassName=type.substring(0,1);return this.get('transition'+type.replace(firstClassName,firstClassName.toLowerCase())+'Class');}},show:function(){if(!this.get('visible')){this._clearTransitionTimer();this._useTransition('init');this.get('element').show();var self=this;setTimeout(function(){self._useTransition('in');},0);this.set('visible',true);}
        return this;},hide:function(){if(this.get('visible')){this._clearTransitionTimer(true);var element=this.get('element');var isTransition=this._useTransition('out');if(isTransition){if(!this._transitionTimer){this._transitionTimer=setTimeout(util.bind(this._transitionEnd,this),200);}}else{this._transitionEnd();}}
        return this;},_clearTransitionTimer:function(f){if(this._transitionTimer){clearTimeout(this._transitionTimer);this._transitionTimer=null;this.set('visible',f||false);}},_transitionEnd:function(){this._clearTransition();this.get('element').hide();this.set('visible',false);},_clearTransition:function(isEnd){var allClass=this._getTransitionClass('init')+' '+
        this._getTransitionClass('in')+' '+
        (!isEnd?this._getTransitionClass('out'):'');this.get('element').removeClass(allClass);},destory:function(){if(this._iframe){this._iframe.destory();delete this._iframe;}
        destory(this,popup.allPopups);destory(this,popup.blurPopups);if(this.get('element')){this.get('element').remove();}
        popup.parent('destory').call(this);},_blurHide:function(arr){arr=$.makeArray(arr);if(util.type.isBoolean(arr[0])){arr.splice(0,1);}
        arr.push(this.get('element'));this._popupElements=arr;popup.blurPopups.push(this);return this;},removeBlurHide:function(){util.array.filter(popup.blurPopups,function(val,index){if(this===val){popup.blurPopups.splice(index,1);}},this);return this;}});popup.allPopups=[];popup.blurPopups=[];function normalizeClassName(name){if(name){name=defaultName+'_'+name;}
    return name;}
    function destory(target,array){$(array).each(function(i,val){if(target===val){array.slice(i,1);}});return array;}
    function hidePopups(e){$(popup.blurPopups).each(function(index,item){if(!item||!item.get('visible')||item._isDialogClose){return;}
        for(var i=0;i<item._popupElements.length;i++){var el=$(item._popupElements[i])[0];if(item._isHide||el===e.target||$.contains(el,e.target)){if(item._isHide){delete item._isHide;}
            return;}}
        item.hide();});}
    $(doc).on('click',function(e){hidePopups(e);});var timeout,winWidth=$(win).width(),winHeight=$(win).height();$(win).on('resize',function(e){timeout&&clearTimeout(timeout);timeout=setTimeout(function(){var winNewWidth=$(win).width();var winNewHeight=$(win).height();if(winWidth!==winNewWidth||winHeight!==winNewHeight){$(popup.allPopups).each(function(i,item){if(!item||!item.get('visible')){return;}
        item.setPosition();item._changeSize&&item._changeSize(e);});}
        winWidth=winNewWidth;winHeight=winNewHeight;},80);});return popup;});;define('widge.overlay.mask',['widge.popup','tools.fixed'],function(require,exports,module){var $=module['jquery'],popup=module['widge.popup'],util=require('base.util'),fixed=require('tools.fixed'),Class=require('base.class').Class,isIE6=!-[1,]&&!window.XMLHttpRequest,win=$(window);var mask=Class(function(o){mask.parent().call(this,util.merge({width:isIE6?win.width():'100%',height:isIE6?win.height():'100%',className:'ui-mask',opacity:0.2,background:'#000',style:{left:0,top:0}},o));}).extend(popup);mask.implement({show:function(){this._changeSize();return mask.parent('show').call(this);},_render:function(){this._isInit=true;mask.parent('_render').call(this);this._renderPosition();this._renderBackground();this._renderOpacity();},_renderPosition:function(){fixed.pin(this.get('element'),0,0);},_renderBackground:function(){this.get('element').css('background',this.get('background'));},_renderOpacity:function(val){this.get('element').css('opacity',val!=undefined?val:this.get('opacity'));},setPosition:function(){},_changeSize:function(e){if(isIE6){this.set('width',win.width());this.set('height',win.height());e&&this.resetSize();this._iframe.resize(win.width(),win.height());}},setBackground:function(val){this.set('background',val);this._renderBackground();},setOpacity:function(val){this.set('opacity',val||this.get('opacity'));this._renderOpacity();},setTransition:function(f){this.set('transitionType',f||false);if(!f){this._renderOpacity();}},show:function(){this._clearTransitionTimer();if(this.get('transitionType')){if(!this.get('visible')){var element=this.get('element');var opacity=element.css('opacity');if(this._isInit){opacity=0;delete this._isInit;}
        this._renderOpacity(opacity);this._useTransition('init');this.get('element').show();var self=this;setTimeout(function(){self._useTransition('in');self._renderOpacity();},0);this.set('visible',true);}}else{return mask.parent('show').call(this);}
        return this;},hide:function(){if(this.get('transitionType')){if(this.get('visible')){this._clearTransitionTimer(true);var element=this.get('element');var isTransition=this._useTransition('out');if(!mask._dialogs||(mask._dialogs&&!mask._dialogs.length)){this._renderOpacity(0);if(!this._transitionTimer){this._transitionTimer=setTimeout(util.bind(this._transitionEnd,this),200);}}else{this._clearTransition(true);this.set('visible',false);}}}else{return mask.parent('hide').call(this);}
        return this;},_getTransitionClass:function(type){return'hb_ui_mask_'+type;}});return new mask();});;define('widge.overlay.hbDialog',['widge.overlay.mask','widge.popup','base.event'],function(require,exports,module){var $=module['jquery'],mask=module['widge.overlay.mask'],popup=module['widge.popup'],events=module['base.event'],util=require('base.util'),Class=require('base.class').Class,template={header:'<div class="ui_dialog_title"></div>',body:'<div class="ui_dialog_container"></div>',close:'<a class="ui_dialog_close" href="javascript:">×</a>',content:'<div class="ui_dialog_content"></div>',loader:'<div class="ui_dialog_loading">正在加载...</div>'},isIE6=!-[1,]&&!window.XMLHttpRequest,lteIE7=/\bMSIE [67]\.0\b/.test(navigator.userAgent),doc=document,hideRet=[];var dialog=Class(function(o){this.readOnlyAttrs={toTarget:true}
    dialog.parent().call(this,util.merge({className:'dialog',trigger:null,hasMask:true,toTarget:null,initHeight:100,height:null,autoHeight:true,zIndex:9999,align:{selfXY:['50%','50%'],baseXY:['50%','50%']},close:null,title:null,content:null,isSingle:false,maskOpacity:null,maskBackground:null},o));}).extend(popup);dialog.implement({init:function(){var trigger=this.get('trigger');trigger&&this._initTrigger();this.after('setPosition',function(){if(lteIE7&&this._header){var p=parseInt(this._header.css('padding-left'))+parseInt(this._header.css('padding-right'));this._header.css('width',this._contentElement.outerWidth()-p);}});dialog.parent('init').call(this);this.setMaskOpacity(this.get('maskOpacity'));this.setMaskBackground(this.get('maskBackground'));this._initElements();this._initKeyEvents();this._initFocus();trigger&&toTabed(this.get('trigger'));toTabed(this.get('element'));},setBlurHideTrigger:function(trigger){if(((util.type.isBoolean(trigger)&&!!trigger)||(trigger&&trigger[0]))&&!this.get('trigger')){this._blurHide(trigger);}
        return this;},_blurHide:function(arr){if(!this.get('trigger')){this.removeBlurHide();return dialog.parent('_blurHide').call(this,arr);}
        return this;},_render:function(){dialog.parent('_render').call(this);this._renderMask();},_toTarget:function(){this.get('element').appendTo(this._getTarget()).hide();},_getTarget:function(f){var target=this.get('toTarget');if(target){if(util.type.isWindow(target[0])){target=f?target[0].document.documentElement:target[0].document.body;}else{throw new Error('widge.overlay.hbDialog: toTarget属性只能指定window对象');}}else{target=f?doc.documentElement:doc.body;}
        return target;},setPosition:function(){var target=this.get('toTarget');if(target){if(target[0].document){this.setDocument(target,target[0].document);}else{throw new Error('widge.overlay.hbDialog: toTarget属性只能指定window对象');}
        this.set('align',$.extend(this.get('align'),{baseElement:this._getTarget(true)}));}else{this.setDocument();}
        dialog.parent('setPosition').call(this);},isInDocument:function(element){return $.contains(this._getTarget(true),element);},_initElements:function(){var element=this.get('element');this._updateCloseBtn();this._contentElement=$(template.content).appendTo(element);this._updateHeader();this._initCloseEvent();this._updateContent();},_updateCloseBtn:function(){var close;if(this._close){this._close.remove();this._close=null;}
        if(close=this.get('close')){this._close=$(template.close).appendTo(this.get('element')).html(close);}},_initCloseEvent:function(){var self=this;this.get('element').on('click','.ui_dialog_close',function(e){e.preventDefault();self.hide();self.trigger('closeX',e);});},_initTrigger:function(){var self=this;this.get('trigger').on('click',function(e){e.preventDefault();self.activeTrigger=$(this);self.show();});},_initFocus:function(){this.after('show',function(){this.get('element').focus();});if(this.activeTrigger){this.after('hide',function(){this.activeTrigger.focus();});}},_initKeyEvents:function(){var self=this;$(doc).on('keyup.esc',function(e){if(e.keyCode===27){self.get('visible')&&self.hide();}});},_updateHeader:function(){if(this.get('title')){var contentElement=this._contentElement;this._header||(this._header=$(template.header).prependTo(contentElement));this._header.html(this.get('title'));}else{if(this._header){this._header.remove();this._header=null;}}},_initMask:function(){mask._dialogs=mask._dialogs||[];},_renderMask:function(){this._initMask();this.after('show',util.bind(this._showMask,this));if(!this.get('isRejcetHideActions')){this.after('hide',util.bind(this._hideMask,this));}},setMaskOpacity:function(val){mask.setOpacity(val);},setMaskBackground:function(val){mask.setBackground(val);},getMask:function(){return mask;},_showMask:function(){if(!this.get('hasMask')){return;}
        mask.setLevel(this.get('zIndex'));mask.setTransition(!!this.get('transitionType'));mask.show().get('element').insertBefore(this.get('element'));isIE6&&setTimeout(function(){mask._renderPosition();mask._changeSize();},1);var existed=false;for(var i=0;i<mask._dialogs.length;i++){if(mask._dialogs[i]===this){existed=true;break;}}
        if(!existed){mask._dialogs.push(this);}},_hideMask:function(){if(!this.get('hasMask')){return;}
        mask._dialogs&&mask._dialogs.pop();if(mask._dialogs&&mask._dialogs.length>0){var last=mask._dialogs[mask._dialogs.length-1];mask.set('zIndex',last.get('zIndex'));mask.get('element').insertBefore(last.get('element'));}else{mask.hide();}},_addLoading:function(){this._loader||(this._loader=$(template.loader).prependTo(this._body));},_removeLoading:function(){if(this._loader){this._loader.remove();delete this._loader;}},_updateContent:function(){this._body||(this._body=$(template.body).appendTo(this._contentElement));this._renderContent();},setContent:function(val){if(!val)return this;if(util.type.isObject(val)){if(val.title){this.set('title',val.title);this._updateHeader();}
        if(val.isAjax){this.set('isAjax',val.isAjax);}
        if(val.isReload){this.setReload(val.isReload);}
        if(val.isOverflow){this._isOverflow=true;}
        if(val.data){this._data=val.data;}
        if(val.content){this.set('content',val.content);this._updateContent();}}else{this.set('content',val);this._updateContent();}
        return this;},setReload:function(f){this.set('isReload',f);return this;},_renderContent:function(){var content=this.get('content');this._removeLoading();if(/^(https?:\/\/|\/|\.\/|\.\.\/)/.test(content)){this._isAjax=!!this.get('isAjax');this.setReload(true);}else{delete this._isAjax;if(this._isAjax==undefined){try{value=$(content);}catch(e){value=[];}
        if(value[0]){this._body.empty().append(value);}else{this._body.empty().html(content);}
        this.setPosition();}}},show:function(f){if(this._isAjax!=undefined&&this.get('isReload')){if(this._isAjax){this._ajaxHtml();}else{this._showIframe();}}else{this.trigger('noRequest');}
        hidDialog();if(this._isSingle()){hideRet.push(this);}
        this._isAjax!=undefined&&this.setReload(f!=undefined?f:true);return dialog.parent('show').call(this);},hide:function(f){if(this.iframe){this.iframe.removeAttr('src');this.iframe.remove();this.iframe=null;}
        if(this._interval){clearInterval(this._interval);delete this._interval;}
        this._isAjax!=undefined&&this.setReload(f!=undefined?f:true);return dialog.parent('hide').call(this);},_ajaxHtml:function(){var self=this,element=this._body;this._addLoading();element.css({height:this.get('initHeight'),overflow:'hidden'});this.trigger('loadStart');var data=this._data||null;element.load(this.get('content'),data,function(){self._removeLoading();var height='auto';if(!self.get('autoHeight')){height=self.get('height')-(self._header?self._header.outerHeight(true):0);height=height-((parseInt(self._body.css('padding-top'))||0)+(parseInt(self._body.css('padding-bottom'))||0)+
        (parseInt(self._body.css('border-top'))||0)+(parseInt(self._body.css('border-bottom'))||0));}
        var cssObj={height:height,overflow:self._isOverflow?'visible':'auto'}
        element.css(cssObj);delete self._isOverflow;delete self._data;self.setPosition();self.trigger('loadComplete');});},_showIframe:function(){var self=this,element=this._body;!this.get('height')&&element.css({height:this.get('initHeight')});if(!this.iframe){this._createIframe();}
        this.trigger('loadStart');this.iframe.attr({src:fixUrl(this.get('content')),name:'hb_dialog_iframe'+new Date().getTime()}).one('load',function(){if(!self.get('visible')){return;}
            if(self.get('autoHeight')){clearInterval(self._interval);self._interval=setInterval(function(){updateHeight.call(self);},300);}
            updateHeight.call(self);self.setPosition();self.trigger('loadComplete');});},_createIframe:function(){var self=this;this.iframe=$('<iframe>',{src:'javascript:;',scrolling:'no',frameborder:'no',allowTransparency:'true',css:{border:'none',width:'100%',display:'block',height:'100%',overflow:'hidden'}}).appendTo(this._body);util.mix(this.iframe[0],events);this.iframe[0].on('close',function(){self.hide();});},addCloseEvent:function(domName,fn){var target=this.query(domName),self=this;if(target[0]){util.mix(target[0],events);target[0].on('close',function(){fn&&fn.call(self);self.hide();});}
        return this;},removeCloseEvent:function(domName){var target=this.query(domName);if(target[0]){target[0].off&&target[0].off('close');}
        return this;},oneCloseEvent:function(domName,fn){return this.removeCloseEvent(domName).addCloseEvent(domName,fn);},fireEvent:function(domName,typeName,fn){if(this.query(domName)[0]){if(util.type.isFunction(typeName)){fn=typeName;typeName="click";}
        if(typeName==="close"){fn=util.bind(this.hide,this);typeName="click";}
        if(isEventType(typeName,fn)){this.query(domName).on(typeName,util.bind(fn,this));}}},addListener:function(typeName,fn){if(isEventType(typeName,fn)){this.on(typeName,util.bind(fn,this));}},removeListener:function(typeName){if(util.type.isString(typeName)){this.off(typeName);}},query:function(selector){return this._body.find(selector);},destory:function(){this.get('element')!=null&&this.get('element').remove();this._hideMask();clearInterval(this._interval);delete this._interval;delete this._errCount;delete this._close;delete this._body;delete this._contentElement;return dialog.parent('destory').call(this,true);},_isSingle:function(){return this.get('isSingle')||this.toString()==="singleConfirmBox"}});function isEventType(name,fn){return util.type.isString(name)&&util.type.isFunction(fn);}
    function updateHeight(){var h;if(!this.get('height')){try{h=getIframeHeight(this.iframe)+'px';}catch(ex){this._errCount=(this._errCount||0)+1;if(this._errCount>=6){h=this.get('initHeight');clearInterval(this._interval);delete this._interval;this._errCount=0;}}
        this._body.css({height:h});}else{clearInterval(this._interval);delete this._interval;}}
    function getIframeHeight(iframe){var doc=iframe[0].contentWindow.document;if(doc.body.scrollHeight&&doc.documentElement.scrollHeight){return Math.min(doc.body.scrollHeight,doc.documentElement.scrollHeight);}else if(doc.documentElement.scrollHeight){return doc.documentElement.scrollHeight;}else if(doc.body.scrollHeight){return doc.body.scrollHeight;}}
    function fixUrl(content){var s=content.match(/([^?#]*)(\?[^#]*)?(#.*)?/);s.shift();s[1]=((s[1]&&s[1]!=='?')?(s[1]+'&'):'?')+'t='+new Date().getTime();return s.join('');}
    function toTabed(element){if(element.attr('tabindex')==null){element.attr('tabindex','-1');}}
    function hidDialog(){var len;if(len=hideRet.length){for(var i=0;i<len;i++){if(hideRet[i]._isSingle()){hideRet[i].set('visible',true);hideRet[i].hide();hideRet.splice(i,1);}}}}
    return dialog;});;define('tools.fixed',function(require,exports,module){var fixed=exports,isIE6=!-[1,]&&!window.XMLHttpRequest,doc=document,$=module['jquery'];if(isIE6){var html=doc.getElementsByTagName('html')[0];doc.execCommand("BackgroundImageCache",false,true);html.style.backgroundImage='url(about:blank)';html.style.backgroundAttachment='fixed';}
    fixed.pin=isIE6?function(elem,x,y,r,b){elem=check(elem);var style=getStyle(elem),scroll=getScroll(),dom='(document.documentElement || document.body)',x=x||getValue(style.left),y=y||getValue(style.top),left,top;if(b){var by=getValue(style.borderTopWidth)+getValue(style.borderBottomWidth);y=getValue(style.height)+by+y;top='eval('+dom+'.scrollTop + '+dom+'.clientHeight - '+y+') + "px"';}else{y=y-scroll.top;top='eval('+dom+'.scrollTop + '+y+') + "px"';}
        if(r){var bx=getValue(style.borderLeftWidth)+getValue(style.borderRightWidth);x=getValue(style.width)+bx+x;left='eval('+dom+'.scrollLeft + '+dom+'.clientWidth - '+x+') + "px"';}else{x=x-scroll.left;left='eval('+dom+'.scrollLeft + '+x+') + "px"';}
        style=elem.style;style.position='absolute';style.removeExpression('left');style.removeExpression('top');style.setExpression('left',left);style.setExpression('top',top);}:function(elem,x,y,r,b){var elem=$(check(elem)),css={position:'fixed'};b=b?'bottom':'top',r=r?'right':'left';css[b]=y||0;css[r]=x||0;elem.css(css);};fixed.unpin=function(elem,styleObj){elem=check(elem);var style=check(elem).style;if(isIE6){style.removeExpression('left');style.removeExpression('top');}
        $(elem).css(styleObj||{'position':'','left':'auto','top':'auto'});}
    function check(elem){elem=$(elem)[0];if(elem.nodeType!==1){throw new Error('tools.fixed: 无效html标签');}
        return elem;}
    function getScroll(){var html=doc.getElementsByTagName('html')[0],dd=doc.documentElement,db=doc.body;return{left:Math.max(dd.scrollLeft,db.scrollLeft),top:Math.max(dd.scrollTop,db.scrollTop)}}
    function getStyle(elem){if(elem.currentStyle){return elem.currentStyle;}else{return getComputedStyle(elem,false);}}
    function getValue(name){return parseInt(name)||0;}
    return fixed;});;define('widge.overlay.confirmBox','widge.overlay.hbDialog',function(require,exports,module){var jquery=module['jquery'],dialog=module['widge.overlay.hbDialog'],util=require('base.util'),Class=require('base.class').Class,template={message:'<div class="ui_dialog_message"></div>',footer:'<div class="ui_dialog_footer"></div>'},list=['title','message','confirmBtn','cancelBtn'];var confirmBox=Class(function(o){confirmBox.parent().call(this,util.merge({confirmBtn:'<button class="button_a button_a_red">确定</button>',cancelBtn:'<button class="button_a cancelbtn">取消</button>',message:null},o));}).extend(dialog);confirmBox.implement({setContent:function(val){if(!val)return;delete this._isAjax;var self=this;if(util.type.isString(val)){this.set('message',val);this._updateMessage();}else if(util.type.isObject(val)){jquery.each(list,function(index,key){if(val[key]){self.set(key,val[key]);if(key==="title"){self._updateHeader();}else if(key==="message"){self._updateMessage();}else if(key==="confirmBtn"||key==="cancelBtn"){self._updateBtn(key);}}});}
        this.setPosition();return this;},_renderContent:function(){this._initTemplate();this.setPosition();},_initTemplate:function(){this._updateMessage();this._updateFooter();},_updateMessage:function(){if(this.get('message')){this._message||(this._message=jquery(template.message).prependTo(this._body));this._message.html(this.get('message'));}},_updateFooter:function(){this._updateBtn('confirmBtn');this._updateBtn('cancelBtn');},_updateBtn:function(btnName){if(this.get(btnName)){this._footer||(this._footer=jquery(template.footer).appendTo(this._body));if(!this['_'+btnName]){this['_'+btnName]=jquery(this.get(btnName));if(isConfirmButton('confirmBtn')){this['_'+btnName].appendTo(this._footer);}else{this['_'+btnName].appendTo(this._footer);}
        this._bindFooterListener(btnName);return;}
        this['_'+btnName].html(this.get(btnName));}},_bindFooterListener:function(btnName){var fn;if(isConfirmButton(btnName)){fn=util.bind(function(e){e.preventDefault();this.trigger('confirm');},this);}else{fn=util.bind(function(e){e.preventDefault();this.trigger('cancel');this.hide();},this);}
        this['_'+btnName].on('click',fn);}});confirmBox.alert=function(message,callback,options){var defaults={message:message,cancelBtn:''}
    var d=new confirmBox(jquery.extend(null,defaults,options)).on('confirm',function(e){callback&&callback.call(this,e);this.hide();}).show();d.toString=function(){return'singleConfirmBox';}
    d.after('hide',function(){this.destory();});return d;}
    confirmBox.confirm=function(message,title,onConfirm,onCancel,options){if(typeof onCancel==='object'&&!options){options=onCancel;onCancel=null;}
        var defaults={message:message,title:title==''?'确认框':title};var d=new confirmBox(jquery.extend(null,defaults,options)).on('cancel',function(e){onCancel&&onCancel.call(this,e);this.hide();}).on('confirm',function(e){onConfirm&&onConfirm.call(this,e);}).show();d.toString=function(){return'singleConfirmBox';}
        d.after('hide',function(){this.destory();});return d;}
    confirmBox.timeBomb=function(message,options,isTrigger){var timeout=3000,firstName="hb_ui_prt_",idName='';var getIcon=function(name){var iconFont="";switch(name){case'success':iconFont='&#xf058;';break;case'fail':iconFont='&#xf057;';break;case'warning':iconFont='&#xf06a;';break;case'question':iconFont='&#xf059;';break;case'info':iconFont='&#xf06a;';break;case'normal':iconFont='&#xf06a;';break;}
        return iconFont?'<i class="hbFntWes">'+iconFont+'</i>':'';}
        if(util.type.isObject(options)){if(util.type.isFunction(options.icons)){getIcon=options.icons;}
            if(options.timeout!=undefined){timeout=options.timeout;delete options.timeout;}
            if(options.name){idName=firstName+options.name;var icons=getIcon(options.name);if(!util.type.isString(icons)){icons='';}
                message=icons+message;delete options.name;}}else if(util.type.isString(options)){idName=firstName+options;message=getIcon(options)+message;options=null;}
        var defaults={className:'prt',message:message,idName:idName,title:null,cancelBtn:null,confirmBtn:null,width:150,hasMask:false,isRejcetHideActions:true},d=new confirmBox(jquery.extend(null,defaults,options)),timer;d.setBlurHideTrigger(isTrigger);d.toString=function(){return'singleConfirmBox';}
        d.after('show',function(){var self=this;timer=timeout?setTimeout(function(){self.hide();},timeout):null;}).show().after('hide',function(){timer&&clearTimeout(timer)&&(timer=null);this.destory();options&&options.callback&&options.callback.call(this);});return d;}
    function isConfirmButton(name){return name==='confirmBtn';}
    return confirmBox;});;define('module.dataSource',function(require,exports,module){var $=module['jquery'],shape=module['base.shape'],util=require('base.util'),cacheName="cache:";var dataSource=shape(function(o){dataSource.parent().call(this,util.merge({source:null,options:{dataType:'json',type:'post',data:null}},o));this.init();});dataSource.implement({init:function(){this.id=0;this.callbacks={};this.setData();},setData:function(source){if(source){this.set('source',source);}else{source=this.get('source');}
        if(util.type.isString(source)){this.set('type','url');if(this.get('options').isCache&&!this._cache){delete this.get('options').isCache;this.set('cacheSize',this.get('options').cacheSize||300);if(this.get('options').cacheSize!=undefined){delete this.get('options').cacheSize;}
            this._cache={};this._cacheMap=[];}}else if(util.type.isArray(source)||util.type.isObject(source)){this.set('type','native');}},setParam:function(data){this.set('options',util.merge(this.get('options'),{data:data}));},setOptions:function(options){if(util.type.isObject(options)){this.set('options',util.merge(this.get('options'),options));}},abort:function(){this.callbacks={};},_done:function(data){this.trigger('data',data);},getData:function(query){var type=capitalize(this.get('type')||'');if(!type){return;}
        return this['_get'+type+'Data'](query);},_getNativeData:function(){var source=this.get('source');this._done(source);return source;},_getUrlData:function(query){var self=this,obj={query:query?encodeURIComponent(query):'',timestamp:new Date().getTime()},url=this.get('source').replace(/\{\{(.*?)\}\}/g,function(all,match){return obj[match];}),callbackId='callback_'+this.id++;if(this.isPending){clearAjax();this.trigger('pending',this._cache);if(this.previousValue===query){return;}}
        if(query&&this._cache&&this._cache[cacheName+query]){clearAjax();this._cache[cacheName+query].isCache=true;this._done(this._cache[cacheName+query]);return;}
        this.isPending=true;this.previousValue=query;var options=util.merge(this.get('options'),{url:url,success:function(data){delete self.callbacks[callbackId];query&&(data.alias=query);self._addCache(query,data);self.isPending=false;self._done(data);},error:function(r,t,e){delete self.callbacks[callbackId];self.isPending=false;self._done({});}});this.callbacks[callbackId]=$.ajax(options);function clearAjax(){for(var callbackId in self.callbacks){delete self.callbacks[callbackId];}}},_addCache:function(name,data){if(name&&this._cache){var cacheSize=this.get('cacheSize'),len=this._cacheMap.length;if(len>=cacheSize){var i=0,l=len-cacheSize;for(;i<l;){delete this._cache[cacheName+this._cacheMap[i++]];}
        this._cacheMap.splice(0,i);}
        if(!this._cache[cacheName+name]){this._cacheMap.push(name);}
        this._cache[cacheName+name]=data;}},getCache:function(name){if(!name||!this._cache)return;return this._cache[cacheName+name];},removeCache:function(name){if(!name&&!this._cache&&!this._cache[cacheName+name]){return;}
        if(this._cacheMap){this._cacheMap.splice(0,1);}
        delete this._cache[cacheName+name];},clearAllCache:function(){if(!this._cache)return;this._cache={};this._cacheMap=[];}});exports.dataSource=dataSource;function capitalize(str){return str.replace(/^([a-z])/,function(f,m){return m.toUpperCase();});}});;define('widge.input',function(require,exports,module){var $=module['jquery'],shape=module['base.shape'],util=require('base.util'),lteIE9=/\bMSIE [6789]\.0\b/.test(navigator.userAgent);keyMap={9:'tab',27:'esc',37:'left',39:'right',13:'enter',38:'up',40:'down'}
    var input=shape(function(o){this.readOnlyAttrs={type:true,keyMap:true,delay:true};input.parent().call(this,util.merge({element:$('#searchInput'),query:null,delay:100,eventType:'autocomplete',keyMap:keyMap},o));this.init();});input.implement({init:function(){this._initEvents();this.set('query',this.getValue());},_initEvents:function(){var input=this.get('element'),type=this.get('eventType'),timer;if(type==='autocomplete'){input.attr(type,'off');}
            input.on('focus.'+type,util.bind(this._handleFocus,this)).on('blur.'+type,util.bind(this._handleBlur,this)).on('keydown.'+type,util.bind(this._handleKeydown,this));if(!lteIE9){input.on('input.'+type,util.bind(this._change,this));}else{var events=['keydown.'+type,'keypress.'+type,'cut.'+type,'paste.'+type].join(' '),self=this;input.on(events,function(e){if(keyMap[e.which])return;timer&&clearTimeout(timer);timer=setTimeout(function(){self._change.call(self,e);},self.get('delay'));});}},_handleFocus:function(e){this.trigger('focus',e);},_handleBlur:function(e){this.trigger('blur',e);},_handleKeydown:function(e){var keyName=keyMap[e.which];if(keyName){var eventKey='key'+ucFirst(keyName);this.trigger(e.type=eventKey,e);}},_change:function(){var newVal=this.getValue(),oldVal=this.get('query'),isSame=compare(oldVal,newVal),isSameExpectWhitespace=isSame?(newVal.length!==oldVal.length):false;if(isSameExpectWhitespace){this.trigger('whitespaceChanged',oldVal);}
            if(!isSame){this.set('query',newVal);this.trigger('queryChanged',newVal,oldVal);}},getValue:function(){return this.get('element').val();},setValue:function(val){this.get('element').val(val);this._change();},destory:function(){input.parent('destory').call(this);}});function compare(a,b){a=(a||'').replace(/^\s*/g,'').replace(/\s{2,}/g,' ');b=(b||'').replace(/^\s*/g,'').replace(/\s{2,}/g,' ');return a===b;}
    function ucFirst(str){return str.charAt(0).toUpperCase()+str.substring(1);}
    return input;});;define('widge.textPlaceHolder','widge.input',function(require,exports,module){var $=module['jquery'],input=module['widge.input'],util=require('base.util'),Class=require('base.class').Class,doc=document,isPlaceHolder="placeholder"in doc.createElement('input');var textPlaceHolder=Class(function(o){textPlaceHolder.parent().call(this,util.merge({element:$('input').eq(0),defaultValue:'请输入关键字',defaultColor:'#999'},o));}).extend(input);textPlaceHolder.implement({init:function(){if(!this.get('element')[0]){this.destory();return;}
        !isPlaceHolder&&this.set('color',this.get('element').css('color'));this._render();textPlaceHolder.parent('init').call(this);},setDefaultValue:function(text){this.set('defaultValue',text);this._render();},_render:function(){var element=this.get('element');if(isPlaceHolder){element.attr('placeholder',this.get('defaultValue'));}else{if(!$.trim(element.val())&&!this._isInputed){this._isInputed=false;element.val(this.get('defaultValue')).css('color',this.get('defaultColor'));}else{this._isInputed=true;}}},_handleFocus:function(e){var element=this.get('element');if(isPlaceHolder){e.isInputed=!$.trim(element.val())?true:false;}else{if($.trim(element.val())==this.get('defaultValue')&&this._isInputed==false){element.val('');this._isInputed=true;}
        e.isInputed=this._isInputed;}
        this.trigger('focus',e);},_handleBlur:function(e){var element=this.get('element');if(isPlaceHolder){e.isInputed=!$.trim(element.val())?false:true;}else{if(!$.trim(element.val())){this._isInputed=false;element.val(this.get('defaultValue')).css('color',this.get('defaultColor'));}
        e.isInputed=this._isInputed;}
        this.trigger('blur',e);},_change:function(){var element=this.get('element');if(!isPlaceHolder){if($.trim(element.val())!=this.get('defaultValue')){this._isInputed=true;}
        element.css('color',this.get('color'));}
        textPlaceHolder.parent('_change').call(this);},getValue:function(){var element=this.get('element');if(isPlaceHolder){return element.val();}else{return this._isInputed?element.val():'';}},setValue:function(val){textPlaceHolder.parent('setValue').call(this,val);if(!isPlaceHolder&&!val){this._isInputed=false;this.get('element').val(this.get('defaultValue')).css('color',this.get('defaultColor'));}}});return textPlaceHolder;});;define('widge.autoComplete.search',['widge.popup','widge.textPlaceHolder','module.dataSource','widge.autoComplete.filter'],function(require,exports,module){var $=module['mobile']||module['jquery'],util=require('base.util'),Class=require('base.class').Class,dataSource=exports.dataSource=require('module.dataSource').dataSource,Filter=require('widge.autoComplete.filter'),popup=module['widge.popup'],Input=module['widge.textPlaceHolder'],lightClassName='item_hl',hoverClassName='item_hover',IE678=/\bMSIE [678]\.0\b/.test(navigator.userAgent),template={header:'',list:'<ul class="options"></ul>',item:'<li><a href="javascript:"  data-url="{link}">{label}</a></li>',footer:{'1':'<li class="itemBottom"><a href="{link}">{icons}搜急聘中的&quot;{label}&quot;的职位&raquo;</a></li>','2':'<li class="itemBottom"><a href="{link}">{icons}搜&quot;{label}&quot;猎头职位&raquo;</a></li>','3':'<li class="itemBottom"><a href="{link}">{icons}搜招聘&quot;{label}&quot;的名优企业&raquo;</a></li>'}},icons={'1':'<span class="hbFntWes"><i>&#xf0e7;</i>急聘</span>','2':'<span class="hbFntWes gray">猎头</span>','3':'<span class="yellow"><em class="icons15_xing"></em></span>'},itemName='a';var search=Class(function(o){search.parent().call(this,util.merge({trigger:$('#searchInput'),className:'search',lightClassName:lightClassName,hoverClassName:hoverClassName,align:{baseXY:[0,'100%']},width:300,height:'auto',maxHeight:null,template:template,isSubmit:false,selectedIndex:-1,dataSource:null,filter:'stringMatch',delay:70,icons:icons,cache:null,defaultValue:'请输入关键字',defaultColor:'#999',isAutoSelect:false},o));}).extend(popup);search.implement({init:function(){var trigger=this.get('trigger');this._isOpen=false;this._isInit=true;search.parent('init').call(this);this._bindBaseElement();this._initElement();},_bindBaseElement:function(){var align=this.get('align');align.baseElement=this.get('trigger');this.set('align',align);},_initElement:function(){this._initInput();this._initData();this._initFilter();this._initEvents();this._initItemEvents();this._blurHide([this.get('trigger')]);},_initInput:function(){this.input=new Input({element:this.get('trigger'),delay:this.get('delay'),defaultValue:this.get('defaultValue'),defaultColor:this.get('defaultColor')});},_initData:function(){var options={source:this.get('dataSource')},cache=this.get('cache');options.options={dataType:'jsonp',type:'get'}
        if(util.type.isBoolean(cache)&&cache!==false){options.isCache=cache;}else if(util.type.isPlainObject(cache)){if(util.type.isBoolean(cache.isCache)&&cache.isCache!==false){options.isCache=cache.isCache;!isNaN(cache.cacheSize)&&(options.cacheSize=cache.cacheSize);}}
        this.dataSource=new dataSource(options);},setData:function(data){if(util.type.isString(data)||util.type.isArray(data)||util.type.isObject(data)){this.dataSource.set('source',data);this.dataSource.setData(data);}},_initFilter:function(){var filter=this.get('filter');filter=initFilter(filter,this.dataSource);this.set('filter',filter);},_initItemEvents:function(){var element=this.get('element'),self=this;element.on('click',itemName,function(e){e.pointTarget=e.target;e.target=this;self._handleSelection.call(self,e);});element.on('mouseenter',itemName,function(e){e.target=this;self._handleMouseMove.call(self,e);});element.on('mouseleave',itemName,function(e){e.target=this;self._handleMouseMove.call(self,e);});element.on('mousedown',itemName,util.bind(this._handleMouseDown,this));},_initEvents:function(){var trigger=this.get('trigger'),element=this.get('element'),self=this;this.dataSource.on('data',util.bind(this._filterData,this));this.input.on('focus',util.bind(this._handleFocus,this));this.input.on('keyEnter',util.bind(this._handleSelection,this));this.input.on('keyEsc',util.bind(this.hide,this));this.input.on('keyUp keyDown',util.bind(this.show,this));this.input.on('keyUp keyDown',util.bind(this._handleStep,this));this.input.on('queryChanged',util.bind(this._handleQueryChange,this));this.after('hide',function(){if(this instanceof search){this.set('selectedIndex',-1);}});this.on('indexChanged',function(e){if(!this.get('isScroll'))return;var maxHeight=this.get('maxHeight'),element=this.get('element'),list=this.get('itemsName'),items=this.get('items'),itemHeight=list.height()/items.length,itemTop=Math.max(0,itemHeight*(e.index+1)-maxHeight);element.scrollTop(itemTop);});},_updateScroll:function(){var maxHeight;if(!(maxHeight=this.get('maxHeight')))
        return
        var element=this.get('element'),list=this.get('itemsName'),height=getLiHeight(list),css;this.set('isScroll',height>maxHeight);if(this.get('isScroll')){css={'overflow-y':'scroll','height':maxHeight};}else{css={'overflow-y':'auto','height':'auto'};}
        element.css(css);},_handleFocus:function(){this._isOpen=true;},_handleMouseDown:function(e){if(IE678){var trigger=this.input.get('element')[0];trigger.onbeforedeactivate=function(){window.event.returnValue=false;trigger.onbeforedeactivate=null;};}
        e.preventDefault();},_handleMouseMove:function(e){var items=this.get('items');if(!items||util.type.isString(items)){return;}
        var index=items.index($(e.target));this.set('selectedIndex',index);this._renderItemsClass('items',index);},_handleSelection:function(e){var isMouse=e?e.type==='click':false,items=this.get('items');if(!items||util.type.isString(items)){return;}
        var index=isMouse?items.index($(e.target)):this.get('selectedIndex'),item=items.eq(index),data=this.get('data')[index];if(index>=0&&item){this.input.setValue(data.text);this.set('selectedIndex',index);if(e&&!isMouse&&!this.get('isSubmit')){e.preventDefault();}
            if(this.get('isAutoSelect')){data.link&&(window.location.href=data.link);}else{var obj={data:data,index:index,target:item,url:data.link,group:items};this.trigger('searchItemSelected',obj);this.hide();}}},_handleStep:function(e){e.preventDefault();this.get('visible')&&this._step(e.type==='keyUp'?-1:1);},_step:function(direction){this._stepItems(direction,'items');},_stepItems:function(direction,itemName,flagName){var currentIndex=this.get('selectedIndex'),items=this.get(itemName);if(!items)return;if(direction===-1){if(currentIndex>-1){this.set('selectedIndex',currentIndex-1);}else{this.set('selectedIndex',items.length-1);}}else if(direction===1){if(currentIndex<items.length-1){this.set('selectedIndex',currentIndex+1);}else{this.set('selectedIndex',-1);}}
        var index=this.get('selectedIndex');this._changeValue(index,flagName);this._renderItemsClass(itemName,index);},_changeValue:function(index,flagName){var data=this.get('data')[index];if(data&&!(!!data.renderType)){this.get('trigger').val(data[flagName||'text']);}},_renderItemsClass:function(itemName,index){var hoverClass=getClassName(this.get('className'),this.get('hoverClassName')),items=this.get(itemName),e={};items&&items.removeClass(hoverClass);e.oldIndex=this.get('oldIndex')?this.get('oldIndex'):-1;if(index===-1)
        return;e.index=index;items.eq(index).addClass(hoverClass);getNodeName(items)===itemName&&this.trigger('indexChanged',e);this.set('oldIndex',index);},_handleQueryChange:function(val,prev){if(this.get('disabled'))return;this.dataSource.abort();this.dataSource.getData(val);},_renderData:function(data){if(data.alias)delete data.alias;data||(data=[]);if(this._isInit){this._renderList();delete this._isInit;}
        this._clear();if(!this._isEmpty()){this._renderItems(data);this.show();}else{if(!this.trigger('emptyData')){this.hide();}}},_renderItems:function(data){var items=this.get('itemsName'),template=this.get('template')||template,self=this,item;if(item=template.item){if(util.type.isArray(data)){var html='',temp={};$.each(data,function(key,val){temp.link=val.link;if(!val.renderType){temp.label=val.text=val.label;if(val.highlightIndex){temp.label=highlightItem(temp.label,self.get('className'),self.get('lightClassName'),val.highlightIndex);}
        html+=util.string.replace(item,temp);}else{html+=self._renderFooter(template.footer,val);}});items.html(html);if(html){this.set('items',items.find(itemName));this._updateScroll();}}else{throw new Error('widge.autoComplete.search: 数据格式不正确');}}else{throw new Error('widge.autoComplete.search: 模板{item}不正确');}},_renderHeader:function(template,val){if(!template&&!val)return'';return util.string.replace(template,val);},_renderFooter:function(template,val){if(!template&&!val)return'';val.label=filterString(this.input.getValue());var icon=this.get('icons')[val.iconType]||'',iconStr=template[(val.iconType||0)+''];if(!iconStr)return'';return util.string.replace(iconStr,util.merge({'icons':icon},val));},_renderList:function(){var template=this.get('template')||template;if(template.list){var element=this.get('element');this.set('itemsName',$(template.list).appendTo(element));}else{throw new Error('widge.autoComplete.search: 模板{ul}不正确');}},show:function(e){this._isOpen=true;if(this._isFireResult())return;search.parent('show').call(this);},_isFireResult:function(){return this._isEmpty();},hide:function(){this._timeout&&clearTimeout(this._timeout);this.dataSource.abort();this._hide();},_hide:function(){this._isOpen=false;search.parent('hide').call(this);},_clear:function(){var items=this.get('itemsName');items&&items.empty();this.set('selectedIndex',-1);this.set('oldIndex',-1);},_filterData:function(data){var filter=this.get('filter');data=filter(normalize(data),this.input.get('query'));this.set('data',data);this._renderData(data);},_isEmpty:function(){var data=this.get('data');return!(data&&data.length>0);},isEmptyContent:function(){return $.trim(this.input.getValue()).length<=0;},destory:function(){this._clear();if(this.input){this.input.destory();this.input=null;}
        search.parent('destory').call(this);}});function filterString(text){if(text.length>10){return text.substr(0,10)+'...';}
    return text;}
    function isLink(el){return(util.type.isString(el)?el:getNodeName(el))==="a";}
    function getLiHeight(ul){var height=0;ul.children().each(function(index,item){height+=$(item).outerHeight(true);});return height;}
    function normalize(data){var result=[];$.each(data,function(index,item){if(util.type.isString(item)){result.push({label:item,value:item,alias:[],link:'javascript:',iconType:0,renderType:false});}else if(util.type.isObject(item)){if(!item.value&&!item.label)return;item.label||(item.label=item.value);item.value||(item.value=item.label);item.alias||(data.alias?item.alias=[data.alias]:item.alias=[]);item.renderType||(item.readerType=false);item.iconType||(item.iconType=0);item.link||(item.link='javascript:');result.push(item);}});return result;}
    function initFilter(filter,dataSource){if(util.type.isString(filter)){if(Filter[filter]){filter=Filter[filter];}else{filter=Filter['default'];}}else if(!util.type.isFunction(filter)){if(dataSource.get('type')==='url'){filter=Filter['default'];}else{filter=Filter['startsWith'];}}
        return filter;}
    function getChildName(node,className,statusClassName){var className=getClassName(className,statusClassName),nodeName;while(node.children().length){node=node.children();if(!node.hasClass(className)){nodeName=getNodeName(node);}}
        return nodeName;}
    function getClassName(className,currentClassName){return className?className+'_'+currentClassName:currentClassName||'';}
    function getNodeName(node){return node[0]&&node[0].nodeName.toLowerCase();}
    function highlightItem(label,className,statusClassName,index,emptyName){className||(className="");var cursor=0,v=label||emptyName||'',resultName,h='';if(util.type.isArray(index)){for(var i=0,l=index.length;i<l;i++){var j=index[i],start,length;if(util.type.isArray(j)){start=j[0];length=j[1]-j[0];}else{start=j;length=1;}
        if(start>cursor){h+=v.substring(cursor,start);}
        if(start<v.length){resultName=getClassName(className,statusClassName);h+='<span class="'+resultName+'">'+v.substr(start,length)+'</span>';}
        cursor=start+length;if(cursor>=v.length){break;}}
        if(v.length>cursor){h+=v.substring(cursor,v.length);}
        return h;}
        return v;}
    return search;});;define('widge.autoComplete.filter',function(require,exports,module){var $=module['jquery'];exports['default']=function(data){return data;}
    exports['startsWith']=function(data,query){query=query||'';var result=[],l=query.length,reg=new RegExp('^'+escapeKeyword(query));if(!l)return[];$.each(data,function(index,item){var a,matchKeys=[item.value].concat(item.alias);while(a=matchKeys.shift()){if(reg.test(a)){if(item.label===a){item.highlightIndex=[[0,l]];}
        result.push(item);break;}}});return result;}
    exports['stringMatch']=function(data,query){query=query||'';var result=[],l=query.length;if(!l)return[];$.each(data,function(index,item){item.highlightIndex=null;var a,matchKeys=[item.value].concat(item.alias);while(a=matchKeys.shift()){if(a.indexOf(query)>-1){if(item.label===a){item.highlightIndex=stringMatch(a,query);}
        result.push(item);break;}}});return result;}
    var keyword=/(\[|\[|\]|\^|\$|\||\(|\)|\{|\}|\+|\*|\?|\\)/g;function escapeKeyword(str){return(str||'').replace(keyword,'\\$1');}
    function stringMatch(matchKey,query){var r=[],a=matchKey.split(''),queryIndex=0,q=query.split('');for(var i=0,l=a.length;i<l;i++){var v=a[i];if(v===q[queryIndex]){if(queryIndex===q.length-1){r.push([i-q.length+1,i+1]);queryIndex=0;continue;}
        queryIndex++;}else{queryIndex=0;}}
        return r;}});;define('product.jobSort.jobSorter',['product.jobSort.jobSortDialog','module.dataSource'],function(require,exports,module){var $=module['jquery'],shape=module['base.shape'],DataSource=module['module.dataSource'],jobSortDialog=module['product.jobSort.jobSortDialog'],util=require('base.util'),template='<li data-id="{value}"><a href="javascript:">{label}<span class="close">×</span></a></li>',hidInput='<input name="{name}" type="hidden" />';var jobSorter=shape(function(o){jobSorter.parent().call(this,util.merge({trigger:$('#dropJobsort'),remenSwitch:'hide',icon:'icon',label:'.label',name:'hidJobsort',maxLength:5,url:'http://assets.huibo.com/js/v2/data/jobSortData.js?v=20150237',initURL:null,initURLParam:null,selectedId:null,dialog:null,search:null,template:template,model:false,level:true},o));this.init();});jobSorter.implement({init:function(){this._initJobSorter();this._initDialog();this._initDataSource();this._initEvents();},_initJobSorter:function(){var trigger=this.get('trigger');this._label=trigger.children(this.get('label'));this._hidInput=trigger.find('input[type="hidden"]');if(!this._hidInput.length){this._hidInput=$(util.string.replace(hidInput,{name:this.get('name')})).appendTo(this.get('trigger'));}
        this._hidInput.val(this.get('selectedId'));},_initDataSource:function(){var url=this.get('initURL'),data=this._dialog.getMenu().getData();if(url){var urlParam=this.get('initURLParam'),param=urlParam?'&'+urlParam+'='+this.get('selectedId'):'';this._initDataSource=new DataSource({source:url+param});var self=this;this._initDataSource.on('data',function(e){if(util.type.isArray(e.data)){$.each(e.data,function(index,val){data.array[index]=val.id;data.object[val.id]=val.label;self._label.append(util.string.replace(self.get('template'),val));});}});this._initDataSource.getData();}else{var label=this._label.children();if(label.length){label.each(function(index,val){var id=$(this).attr('data-id');data.array[index]=id;data.object[id]=$(this).text().replace(/[×xX]/gi,'');});}}
        this._dialog.updateSearchData();},_initDialog:function(){this._dialog=new jobSortDialog({maxLength:this.get('maxLength'),remenSwitch:this.get('remenSwitch'),selectedId:this.get('selectedId'),template:this.get('template'),model:this.get('model'),level:this.get('level'),url:this.get('url'),dialog:util.merge({idName:'hbJobSortDialog',width:854,height:'auto',title:'选择职位类别'},this.get('dialog')),search:util.merge({idName:'jobSearch',width:290,align:{baseXY:[-1,'100%-1']},size:10,dataSource:null,defaultValue:'关键词快速匹配，点击选中'},this.get('search'))});},_initEvents:function(){var trigger=this.get('trigger'),self=this;trigger.on('click',function(e){var target=$(e.target);if(target.hasClass('close')){target=target.closest('li');target.remove();var value=target.attr('data-id');self._dialog.deleteItem([target,self._dialog._resultPanel.children('span[data-id='+value+']')],value);self._hidInput.val(self.getValue().array.join(','));}else if(target[0]==self.get('trigger')[0]||(self.get('icon')&&target.hasClass(self.get('icon')))){self._dialog.show();}});this._dialog.on('submit',function(e){self._label.html(e.html);self._hidInput.val(e.value);this.hide();self.trigger('submit',e);});},addItem:function(e){if(!e)return;var menu=this._dialog._menu;if(menu.addSelectedItem(e.value,e.label)){this._label.append(util.string.replace(this.get('template'),e));this._dialog._addItemHTML(e);}
        this.updateData();},clearAllItem:function(){this._label.empty();this._dialog.clearAllItem();},updateData:function(){this._dialog.updateSearchData();this._hidInput.val(this.getValue().array.join(','));},getValue:function(){return this._dialog.getMenu().getData();},destory:function(){this._dialog.destory();jobSorter.parent('destory').call(this);},hide:function(){this._dialog.hide();}});return jobSorter;});;define('product.jobSort.jobSortDialog',['product.jobSort.jobSortMenu','product.jobSort.jobSortSearch','widge.overlay.hbDialog','widge.overlay.confirmBox'],function(require,exports,module){var $=module['jquery'],shape=module['base.shape'],hbDialog=module['widge.overlay.hbDialog'],ConfirmBox=module['widge.overlay.confirmBox'],jobSortMenu=module['product.jobSort.jobSortMenu'],search=module['product.jobSort.jobSortSearch'],util=require('base.util'),loader='<div class="loader" style="text-align:center">正在加载数据中...</div>',loaderError=['<div class="loader" style="text-align:center">错误：加载数据失败</div>','<div class="jobBottomBox" style="text-align:center"><a class="yesBtn" href="javascript:" style="margin:0">确定</a></div>'].join(''),oneLengthHTML='选择<em>{maxLength}</em> 项',maxLengthHTML='最多<em>{maxLength}</em> 项',content=[loader,'<div class="jobPanel" style="display:none">','<div class="jobTopActionsPanel clearfix">','<div class="jobTopActionsLeft">','<div class="jobTopSearchInput"><em></em><input id="jobTopSearchInput" /></div>','{maxLengthHTML}','</div>','<div id="jobTopResult" class="jobTopResult"></div>','</div>','<div class="jobContentBox {oneClass}">','<div class="jobSortMenu"><ul></ul></div>','<div class="jobSortItems"></div>','</div>','{jobBottomBox}','</div>'].join(''),cancelButtonTemplate='<a class="cancelBtn" href="javascript:">取消</a>',yesButtonTemplate='<a class="yesBtn" href="javascript:">确认</a>',resultItemTemplate='<span data-id="{value}">{label}<a href="javascript:"></a></span>',promptMsgs={'limit':'不能超过{maxLength}项','repeat':'不能重复选择'},jobBottomBoxTemplate=['<div class="jobBottomBox">',yesButtonTemplate,cancelButtonTemplate,'</div>'].join(''),pWidth=70,fontSize=18;var jobSortDialog=shape(function(o){jobSortDialog.parent().call(this,util.merge({maxLength:5,remenSwitch:"hide",selectedId:null,model:false,oneLengthHTML:oneLengthHTML,maxLengthHTML:maxLengthHTML,dialog:{idName:'hbJobSortDialog',width:854,height:'auto',title:'选择类型'},search:{idName:'jobSearch',width:290,align:{baseXY:[-1,'100%-1']},size:10,dataSource:null},url:'http://assets.huibo.com/js/v2/data/jobSortData.js?v=20150227',level:true},o));this.init();});jobSortDialog.implement({init:function(){this._isInit=true;this._initDialog();this._initResultPanel();this._initMenu();this._initSearch();this._initEvents();},_initDialog:function(){this._dialog=new hbDialog(this.get('dialog'));var maxLength=this.get('maxLength'),html=this.get('maxLengthHTML'),jobBottomBox=jobBottomBoxTemplate,oneClass='',f=true;if(maxLength==1){html=this.get('oneLengthHTML');f=false;}else if(maxLength<=0){html='';f=false;}
        if(!f){jobBottomBox='';this._dialog.set('close','x');this._dialog._updateCloseBtn();oneClass='jobContentBox_one';}
        var dialogContent=util.string.replace(content,{'jobBottomBox':jobBottomBox,'oneClass':oneClass,'maxLengthHTML':html});this._dialog.setContent(util.string.replace(dialogContent,{'maxLength':maxLength}));},_initSearch:function(){this._search=new search(util.merge({trigger:this._dialog.query('#jobTopSearchInput'),zIndex:this._dialog.get('zIndex')+1},this.get('search')));},_initMenu:function(){var self=this;this._menu=new jobSortMenu({element:this._dialog.query('.jobSortItems'),trigger:this._dialog.query('.jobSortMenu'),selectedId:this.get('selectedId'),maxLength:this.get('maxLength'),remenSwitch:this.get('remenSwitch'),model:this.get('model'),url:this.get('url'),level:this.get('level')});this._menu.on('initItem',function(e){if(!self._resultPanel.children('span[data-id='+e.value+']').length){self._resultPanel.append(util.string.replace(resultItemTemplate,e));}});this._menu.on('initError',function(e){self._dialog.setContent(loaderError);self._dialog.query('.yesBtn').on('click',function(){self._dialog.hide();});});},_initResultPanel:function(){this._resultPanel=this._dialog.query('#jobTopResult');},getItemHTML:function(){var data=this._menu.getData(),template=this.get('template'),label,resultHTML='';this._labels=[];if(!template){return'';}
        for(var i=0,len=data.array.length;i<len;i++){if(label=data.object[data.array[i]]){this._labels.push(label);resultHTML+=util.string.replace(template,{value:data.array[i],label:label});}}
        return resultHTML;},_initEvents:function(){var self=this;function submitClick(e){var data=self._menu.getData().array;e.html=self.getItemHTML();e.value=data.join(',');e.data={value:data,label:self._labels&&self._labels||[]};self.trigger('submit',e);}
        this._dialog.query('.yesBtn').on('click',submitClick);this._dialog.query('.cancelBtn').on('click',function(e){delete self._labels;var eventObj;self.clearAllItem();self._oldItem.each(function(key,val){eventObj={label:$(this).text(),value:$(this).attr('data-id')}
            self.addItem(eventObj);});self.updateSearchData();self.trigger('cancel',e);self.hide();});this._menu.on('loadComplete',function(){self._dialog.query('.loader').remove();self._dialog.query('.jobPanel').show();self._dialog.setPosition();self._oldItem=self._resultPanel.children().clone();self.updateSearchData();});this._menu.on('selectItem',function(e){if(e.result&&e.result.length){var span=self._resultPanel.find('span');for(var i=0,len=e.result.length;i<len;i++){span.filter('[data-id='+e.result[i]+']').remove();}}
            var searchItems=self._search.get('items');self._resultPanel.append(util.string.replace(resultItemTemplate,e));self.updateSearchData();if(self.get('maxLength')==1){searchItems&&searchItems.removeClass('selected');if(!e.sourceName){submitClick(e);}}
            searchItems&&searchItems.filter('[data-id='+e.value+']').addClass('selected');});this._menu.on('clickAll',function(e){self._search.get('items')&&self._search.get('items').removeClass('selected');});this._menu.on('one',function(){self.clearAllItem();self.updateSearchData();});this._menu.on('limit',function(e){self.updateSearchData();var msg=util.string.replace(promptMsgs.limit,{maxLength:this.get('maxLength')});ConfirmBox.timeBomb(msg,{name:'fail',width:pWidth+msg.length*fontSize,timeout:800});});this._menu.on('notSelectItem',function(e){self.updateSearchData();var msg=promptMsgs.repeat;ConfirmBox.timeBomb(msg,{name:'fail',width:pWidth+msg.length*fontSize,timeout:800});});this._resultPanel.on('click','a',function(e){var target=$(e.currentTarget).parent(),id=target.attr('data-id');self.deleteItem(target,id);self._search.get('items').filter('[data-id='+id+']').removeClass('selected');});this._search.on('searchItemSelected',function(e){var menu=self._menu,value=e.url,eventObj={label:e.data.value,value:value,result:menu._handleResult(value)};var maxLength=self.get('maxLength');if(e.selected){if(menu.addSelectedItem(value,eventObj.label)===true){if(maxLength==1){this.hide();submitClick(e);eventObj.sourceName='search';}
            menu.trigger('selectItem',eventObj);}else if(menu.addSelectedItem(value,eventObj.label)==='limit'){menu.trigger('limit',eventObj);}else{menu.trigger('notSelectItem',eventObj);}}else{e.target.removeClass('selected');var target=self._resultPanel.children('span[data-id='+value+']');self.deleteItem(target,value);}});},clearAllItem:function(){this._resultPanel.empty();this._menu.clearSelectedItem();},addItem:function(e){if(!e)return;var menu=this._menu;if(menu.addSelectedItem(e.value,e.label)){this._addItemHTML(e);}
        this.updateSearchData();},_addItemHTML:function(e){if(!e)return;this._resultPanel.append(util.string.replace(resultItemTemplate,e));},deleteItem:function(target,val){if(!val)return;if(util.type.isArray(target)){for(var i=0,len=target.length;i<len;i++){target[i].remove();}}else{target.remove();}
        this._menu.delSelectedItem(val);this.updateSearchData();},updateSearchData:function(){this._search.set('datas',this._menu.getData(),{override:true});},getMenu:function(){return this._menu;},getSearch:function(){return this._search;},show:function(){if(this._isInit){var self=this;setTimeout(function(){self._menu.init();},1);delete this._isInit;}else{this._oldItem=this._resultPanel.children().clone();}
        this._dialog.show();},hide:function(){this._dialog.hide();},destory:function(){this._menu.destory();this._search.destory();this._dialog.destory();jobSortDialog.parent('destory').call(this);}});return jobSortDialog;});;
        define('product.jobSort.jobSortSearch',['widge.autoComplete.search'],function(require,exports,module){var $=module['jquery'],shape=module['base.shape'],search=module['widge.autoComplete.search'],util=require('base.util'),template={list:'<ul class="options"></ul>',item:'<li><a {selected} href="javascript:" data-id="{link}"><span class="status"></span>{label}</a></li>',footer:'<div class="footer"><a href="javascript:">换一批</a><span>共{count}个</span></div>',empty:'<div class="empty">没找到职位，换个关键词试试！</div>'},itemName='a';var jobSortSearch=shape(function(o){jobSortSearch.parent().call(this,util.merge({template:template,size:10,datas:null},o));}).extend(search);jobSortSearch.implement({_initEvents:function(){jobSortSearch.parent('_initEvents').call(this);var element=this.get('element'),options=element.children('.options'),self=this;element.on('click','.footer a',function(e){if(self.get('disabled'))return;self.dataSource.abort();self.dataSource.set('source',self._nextURL);self.dataSource.getData(self.input.get('element').val());});this.input.on('focus',util.bind(this.show,this));this.on('emptyData',function(e){if(self._emptyContent){self._emptyContent.remove();delete self._emptyContent;}
        if(self.isEmptyContent()){search.parent('hide').call(self);return;}
        self._emptyContent=$(self.get('template').empty).appendTo(element);search.parent('show').call(self);});},_initData:function(){var dataSource=this.get('dataSource');if(util.type.isString(dataSource)){this.set('dataSource',dataSource.replace(/\{\{pageSize\}\}/g,this.get('size')));}
        jobSortSearch.parent('_initData').call(this);},_handleQueryChange:function(val,prev){if(this.get('disabled'))return;this.dataSource.set('source',this.get('dataSource'));this.dataSource.abort();this.dataSource.getData(val);},_filterData:function(data){var oldData=data;if(util.type.isObject(data)){data=data.data||data;}
        jobSortSearch.parent('_filterData').call(this,data);if(this._footer){this._footer.remove();delete this._footer;}
        if(oldData.totalPage&&oldData.totalPage>1){this._footer=$(util.string.replace(template.footer,{count:oldData.totalSize})).appendTo(this.get('element'));var page=oldData.pageNo+1;if(page>oldData.totalPage){page=1;}
            this._nextURL=this.get('dataSource')+'&page='+page;}},_handleSelection:function(e){var isMouse=e?e.type==='click':false,items=this.get('items');if(!items||util.type.isString(items)){return;}
        var index=isMouse?items.index($(e.target)):this.get('selectedIndex'),item=items.eq(index),data=this.get('data')[index];if(index>=0&&item){this.set('selectedIndex',index);if(e&&!isMouse&&!this.get('isSubmit')){e.preventDefault();}
            if(this.get('isAutoSelect')){data.link&&(window.location.href=data.link);}else{var selected=!item.hasClass('selected');var obj={data:data,index:index,target:item,url:data.link,group:items,selected:selected};this.trigger('searchItemSelected',obj);}}},_renderItems:function(data){if(this._emptyContent){this._emptyContent.remove();delete this._emptyContent;}
        var items=this.get('itemsName'),template=this.get('template')||template,self=this,item,d=this.get('datas').object;if(item=template.item){if(util.type.isArray(data)){var html='',temp={};$.each(data,function(key,val){if(d[val.link]){temp.selected='class="selected"';}else{temp.selected='';}
            temp.link=val.link;temp.label=val.text=val.label;html+=util.string.replace(item,temp);});items.html(html)
            if(html){this.set('items',items.find(itemName));}}else{throw new Error('widge.autoComplete.search: 数据格式不正确');}}else{throw new Error('widge.autoComplete.search: 模板{item}不正确');}},_changeValue:function(){}});return jobSortSearch;
        });

        ;define('product.jobSort.jobSortMenu',function(require,exports,module){var $=module['jquery'];shape=module['base.shape'],util=require('base.util'),doc=document,template={triggerItem:'<li><a class="sub_item" href="javascript:"><!--<i class="hbFntWes">&#xf105;</i>-->{name}</a></li>',firstItem:'<li class="first_item"><a data-id="0" class="sub_item" href="javascript:">不限</a></li>',elementGroup:'<table class="child_item" cellpadding="0"></table>',elementCols:'<div></div>',elementRows:'<tr></tr>',elementTitle:'<th><{tag} href="javascript:" data-id="{id}">{name}</{tag}></th>',elementList:'<td><div></div></td>',elementItem:'<a href="javascript:" data-id="{id}">{name}</a>'}
    var jobSortMenu=shape(function(o){jobSortMenu.parent().call(this,util.merge({element:null,trigger:null,elementItem:'.child_item',triggerMenu:'ul',triggerItem:'li',className:'hover',selectedClassName:'item_selected',delayHoverTime:300,selectedIndex:0,maxLength:5,selectedId:null,model:false,level:true,isAll:false},o));this._initSelectedItem();});jobSortMenu.implement({init:function(){this._index=0;this._renders={};var self=this;hbjs.loadJS(this.get('url'),function(moduleName){moduleName=moduleName.substring(moduleName.lastIndexOf('/')+1,moduleName.lastIndexOf('.js'));self.set('data',hbjs[moduleName]);if(!self.get('data')){self.trigger('initError');return;}
            self._triggerMenu=self.get('trigger').find(self.get('triggerMenu'));self._renderTemplate();self._triggerItem=self._triggerMenu.find(self.get('triggerItem'));self._items=self.get('element').find('.child_item');self.selectMenu(self.get('selectedIndex'));self._initEvents();});},_initSelectedItem:function(){var selectedId=this.get('selectedId');this._selectedId=[];this._selectedObj={};if(selectedId&&util.type.isString(selectedId)){this._selectedId=selectedId.split(',');}else if(util.type.isArray(selectedId)){this._selectedId=selectedId;}
            if(this._selectedId.length){for(var i=0,len=this._selectedId.length;i<len;i++){this._selectedObj[this._selectedId[i]]=true;}}},getData:function(){return{array:this._selectedId,object:this._selectedObj}},_initEvents:function(){var self=this,trigger=this.get('trigger'),itemName=this.get('triggerItem'),switchTimer,switchTimeout=this.get('delayHoverTime'),limit=3,resultPos=null;this.pos=[];$(doc).on('mousemove',function(e){self.pos.push({x:e.pageX,y:e.pageY});if(self.pos.length>limit){self.pos.shift();}});trigger.on('mouseenter',itemName,function(e){var target=$(e.currentTarget);switchTimer&&clearTimeout(switchTimer);if(!target.hasClass('first_item')){switchTimer=setTimeout(function(){overHandle(e);},timeout());}else{overHandle(e,true);}}).on('mouseleave',leaveHandle).on('click','.first_item a',function(e){selectedItem(e);self.trigger('clickAll',e);});var element=this.get('element');element.on('mouseleave',leaveHandle).on('click','a',selectedItem);function selectedItem(e){var target=$(e.currentTarget),value=target.attr('data-id'),eventObj={target:target,label:target.text(),value:value,result:self._handleResult(value)};if(self.addSelectedItem(value,eventObj.label)===true){self.trigger('selectItem',eventObj);}else if(self.addSelectedItem(value,eventObj.label)==='limit'){self.trigger('limit',eventObj);}else{self.trigger('notSelectItem',eventObj);}}
            function overHandle(e,f){var target=$(e.currentTarget),index=self._triggerItem.index(target);self.selectMenu(index,f);}
            function leaveHandle(e){switchTimer&&clearTimeout(switchTimer);}
            function timeout(){var offset=trigger.offset(),dimStart={x:offset.left+trigger.width(),y:offset.top},dimEnd={x:offset.left+trigger.width(),y:offset.top+trigger.height()},endPos=self.pos[self.pos.length-1],startPos=self.pos[0];if(!endPos){return 0;}
                if(!startPos){startPos=endPos;}
                if(startPos.x<offset.left||startPos.x>dimEnd.x||startPos.y<offset.top||startPos.y>dimEnd.y){return 0;}
                if(resultPos&&endPos.x==resultPos.x&&endPos.y==resultPos.y){return 0;}
                var cloneStart=dimStart,cloneEnd=dimEnd,L=J(endPos,cloneStart),H=J(endPos,cloneEnd),D=J(startPos,cloneStart),A=J(startPos,cloneEnd);if(L<D&&H>A){k=endPos;return self.get('delayHoverTime');}
                k=null;return 0;}},_handleResult:function(val){var lastReg=/^(\d+)00$/gi,isSort=lastReg.test(val),firstId=val.substring(0,val.length-2),selectedId=[].concat(this._selectedId),selId,ret=[];if(!isSort){firstId=firstId+'00';}
            for(var i=0,len=selectedId.length;i<len;i++){if(val!=0){selId=isSort?selectedId[i].substring(0,selectedId[i].length-2):selectedId[i];if(selectedId[i]==0){delete this._selectedObj[this._selectedId[i]];this._selectedId.splice(i-ret.length,1);ret.push(selectedId[i]);continue;}
                if(firstId===selId){if(!(isSort&&this._selectedObj[val])){delete this._selectedObj[this._selectedId[i-ret.length]];this._selectedId.splice(i-ret.length,1);}
                    ret.push(selectedId[i]);if(!isSort){break;}}}else{delete this._selectedObj[this._selectedId[i-ret.length]];this._selectedId.splice(i-ret.length,1);ret.push(selectedId[i]);}}
            return ret;},isLimit:function(){var selectedId=this._selectedId;return selectedId.length>=this.get('maxLength');},isSelected:function(val){if(!this._selectedId.length){return false;}
            if(this._selectedObj[val]){return true;}
            return false;},clearSelectedItem:function(){this._selectedObj={};this._selectedId=[];},addSelectedItem:function(val,label){if(!this.isSelected(val)){if(this.get('maxLength')==1){this.trigger('one');}
            if(this.isLimit()){return'limit';}
            this._selectedObj[val]=label||true;this._selectedId.push(val);return true;}
            return false;},delSelectedItem:function(val){var selectedId=this._selectedId;if(!selectedId.length){return;}
            for(var i=0,len=selectedId.length;i<len;i++){if(val==selectedId[i]){delete this._selectedObj[val];this._selectedId.splice(i,1);return;}}},selectMenu:function(index,f){this._triggerItem.removeClass(this.get('className'));this._triggerItem.eq(index).addClass(this.get('className'));this._index=index;if(!f){this._items.hide();this._items.eq(index).show();}},_renderItem:function(target,val,obj,index){var self=this,model=this.get('model'),el;if(this.get('level')){target=$(template.elementRows).appendTo(target);$(val).each(function(i,val){val.tag=model?'span':'a';el=$(util.string.replace(template.elementTitle,val)).appendTo(target);if(obj&&obj.renders){self._renderSelectedClass(obj.renders,el,obj.index,val);}
            if(self._selectedObj[val.id]){self._selectedObj[val.id]=val.name;self.trigger('initItem',{label:val.name,value:val.id});}
            target=$(template.elementList).appendTo(target).children();if(val.sub&&util.type.isArray(val.sub)){$(val.sub).each(_renderItems);}});}else{target=$('<div></div>').appendTo(target);if(obj&&obj.renders){this._renderSelectedClass(obj.renders,target,obj.index,val);}
            _renderItems(index,val);}
            function _renderItems(index,value){if(self._selectedObj[value.id]){self._selectedObj[value.id]=value.name;self.trigger('initItem',{label:value.name,value:value.id});}
                el=$(util.string.replace(template.elementItem,value)).appendTo(target);if(obj&&obj.renders){self._renderSelectedClass(obj.renders,el,obj.index+1,value);}}},_renderItems:function(target,val,obj){var self=this,id=obj.length;if(!this.get('level')){target=$(template.elementRows).appendTo(target);target=$(template.elementList).appendTo(target).children().addClass('simple');}
            $(val).each(function(key,val){self._renderItem(target,val,{renders:obj,index:id},key);});},_renderTemplate:function(){if(this.get('isAll')){this._triggerMenu.append(template.firstItem);this.get('element').append(template.elementGroup);}
            $(this.get('data')).each(util.bind(this._eachList,this));this.trigger('loadComplete');},_eachList:function(index,val){var el=$(util.string.replace(template.triggerItem,val)).appendTo(this._triggerMenu);this._renderSelectedClass(this._renders[index]=[],el,0,val);if(val.sub&&util.type.isArray(val.sub)){childItem=$(template.elementGroup).appendTo(this.get('element'));this._renderItems(childItem,val.sub,this._renders[index],index);childItem.css({'visibility':'','display':'none'});delete this._renders[index];}},_renderSelectedClass:function(render,el,index,val){el=el.children().length?el.children():el;if(index===1&&render.length>=3){render.splice(render.length-1,1);}
            render[index]=el;if(this.isSelected(val)){for(var i=render.length-1;i>=0;i--){if(!render[i]){render.splice(render.length-1,1);continue;}
                render[i].addClass(this.get('selectedClassName'));}
                render.splice(index,1);}
            this._renders[index]=render;}});function J(o,n){return(n.y-o.y)/(n.x-o.x);}
    return jobSortMenu;});